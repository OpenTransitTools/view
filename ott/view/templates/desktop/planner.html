<%inherit file="/desktop/base.html"/>
<%namespace name="util"  file="/shared/util.mako"/>
<%namespace name="plib"  file="/shared/planner.mako"/>
<%def name="title()">TriMet: ${_(u'Trip Planner')} - ${_(u'From')} ${plan['from']['name']} ${_(u'to')} ${plan['to']['name']}</%def>
<%def name="app_css()">
    <link rel="stylesheet" href="${util.url_domain()}/css/triptools-tp.css" type="text/css" media="all" />
    <script src="${util.url_domain()}/scripts/triptools.js"></script>
</%def>
<%def name="meta_data()">
    <meta name="Keywords"    content="triplanner, trip planner, open trip planner, OTP, route planner, planner, transit planner"/>
    <meta name="Description" content="text interface for trimet trip planner"/>
</%def>
<%def name="planner_selected()">class="selected"</%def>
<%def name="side_bar()">
    <aside id="aside" class="aside">
        <div id="trimet-ads">
            %if adverts:
                %for a in adverts:
                    ${a['content'] | n}
                %endfor
            %endif
        </div><!-- end #trimet-ads -->
        <div id="sidebar-icons">
            <p class="helptips"><a href="${util.url_domain()}/tripplanner/trip-help.htm" target="#"><span>${_(u'Help/tips')}</span></a></p>
            <p class="showonmap"><a href="http://ride.trimet.org?mapit=I&submit&${plan['params']['map_planner']}" target="#"><span>${_(u'Show this trip on Interactive Map')}</span></a></p>
            <p class="feedbackreport"><a href="/feedback.html?app=${plan['params']['feedback_url']}" onClick="_gaq.push(['_trackEvent', 'Trip Planner Ads','ClickTo', '/contact/']);"><span>${_(u'Feedback/report a problem')} ${plan['params']['feedback_txt']}</span></a></p>
        </div><!-- end #sidebar-icons -->
        
    </aside><!-- end #sidebar -->
</%def>
##
## main content
##
<%
    is_mobile = False
    itinerary = plib.get_itinerary(plan)
%>

    <h1 class="tripplanner-icon"><a href="planner_form.html">${_(u'Your Trip on TriMet')}</a></h1>
    <div id="details" class="group">
        <p class="origin"><img src="${util.img_url()}/start-end.png" width="0" height="1" /><strong>${_(u'From')}</strong> ${plan['from']['name']}</p>
        <p class="destination"><img src="${util.img_url()}/start-end.png" width="0" height="1" /><strong>${_(u'To')}</strong> ${plan['to']['name']}</p>
        <p class="tripinfo">${plib.get_depart_arrive(plan['params']['is_arrive_by'])} ${plib.get_time(itinerary, plan['params']['is_arrive_by'])} ${itinerary['date_info']['pretty_date']}, ${_(u'using')} ${plan['params']['modes']} <a href="planner_form.html?${plan['params']['edit_trip']}" onclick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary edit top']);" class="hide">${_(u'Edit')}</a></p>
        <p class="tripinfo">${plib.get_optimize(plan['params']['optimize'])} ${_(u'with a maximum walk of')} ${plan['params']['walk']} <a href="planner_form.html?${plan['params']['edit_trip']}" onclick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary edit top']);" class="hide">${_(u'Edit')}</a></p>
    </div><!-- end #details -->

    %if len(plan['itineraries']) > 1:
    <ol id="plannertabs" class="group">
        ${plib.itin_tab(plan['itineraries'], 0, _(u'Your best bet'))}
        ${plib.itin_tab(plan['itineraries'], 1, _(u'Option 2'))}
        ${plib.itin_tab(plan['itineraries'], 2, _(u'Option 3'))}
    </ol><!-- end #tabs -->
    %endif

    <ol id="itinerary" class="transit">
        ##
        ## loop through the legs between start and end elements
        ## ${plib.render_leg(leg, n)}
        %for n, leg in enumerate(itinerary['legs']):
            ${plib.render_leg(leg, n, is_mobile)}
        %endfor
    </ol><!-- end #itinerary -->

    ${plib.render_fares(itinerary, util.url_domain() + '/fares/index.htm')}

    %if itinerary['has_alerts']:
    <div id="alerts" class="group">
        %for alert in itinerary['alerts']:
        <p><img src="${util.img_url()}/alert.png" />
            <span class="alert-text">${alert['text']}</span>
            <span class="alert-time">${_(u'As of')} ${alert['start_date_pretty']}   <a href="${alert['url']}" target="#">${_(u'(more...)')}</a></span>
        </p>
        %endfor
    </div><!-- end #alerts -->
    %endif


    <div id="console" class="group hide">
        <p class="console-left">
            <a href="#" class="console-emailtext" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary email-text']);"><span>${_(u'Email/Text')}</span></a>
            <a href="javascript:window.print();" class="console-print" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'PrintClickTo', 'Itinerary print']);"><span>${_(u'Print')}</span></a>
            <a href="#" class="console-mobile" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary view on mobile']);"><span>${_(u'View on mobile')}</span></a>
        </p>
        <p class="console-right">
            <a href="planner_form.html?${plan['params']['return_trip']}" class="console-returntrip" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary reverse']);"><span>${_(u'Return trip')}</span></a>
            <a href="planner_form.html?${plan['params']['edit_trip']}" class="console-edit" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary edit']);"><span>${_(u'Edit/Start over')}</span></a>
        </p>
    </div><!-- end #console -->





