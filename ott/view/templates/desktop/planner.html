<%inherit file="/desktop/base.html"/>
<%namespace name="util"  file="/shared/util.mako"/>
<%namespace name="plib"  file="/shared/planner.mako"/>
<%def name="title()">TriMet: ${_(u'Trip Planner')} - ${_(u'From')} ${plan['from']['name']} ${_(u'to')} ${plan['to']['name']}</%def>
<%def name="app_css()">
    <link rel="stylesheet" href="${util.url_domain()}/css/triptools-tp.css" type="text/css" media="all" />
    <script src="${util.url_domain()}/scripts/triptools.js"></script>
</%def>

<%def name="meta_data()">
    <meta name="Keywords"    content="Triplanner, OTP, routeplanner, planner"/>
    <meta name="Description" content=""/>
</%def>
<%def name="planner_selected()">class="selected"</%def>
<%def name="side_bar()">
    <aside id="aside" class="aside">
        <div id="trimet-ads">
            %if adverts:
                TODO format itinerary ads
                %for a in adverts:
                    ${a['content'] | n}
                %endfor
            %endif
            <p><a href="#" class="group" onclick="_gaq.push(['_trackEvent', 'TriMetAds-TripPlanner', 'ClickTo', 'Fares']);"><img src="${util.img_url()}/ads/fare.png"><span>No fare increases right now. Just lettin' you know!</span></a></p>
            <p><a href="#" class="group" onclick="_gaq.push(['_trackEvent', 'TriMetAds-TripPlanner', 'ClickTo', 'Mobile ticketing']);"><img src="${util.img_url()}/ads/mobile.png"><span>Mobile ticketing for smartphones coming summer 2013.</span></a></p>
            <p><a href="#" class="group" onclick="_gaq.push(['_trackEvent', 'TriMetAds-TripPlanner', 'ClickTo', 'Gear store']);"><img src="${util.img_url()}/ads/gear.png"><span>Order mugs, bags, t-shirts and more in the TriMet Gear Store.</span></a></p>
            <p><a href="#" class="group" onclick="_gaq.push(['_trackEvent', 'TriMetAds-TripPlanner', 'ClickTo', 'CO2']);"><img src="${util.img_url()}/ads/co2.png"><span>Taking this trip instead of driving will help the environment.</span></a></p>
        </div><!-- end #trimet-ads -->
        <div id="sidebar-icons">
            <p class="helptips"><a href="${util.url_domain()}/tripplanner/trip-help.htm"><span>${_(u'Help/tips')}</span></a></p>
            <p class="showonmap"><a href="http://ride.trimet.org?mapit=I"><span>${_(u'Show this trip on Interactive Map')}</span></a></p>
            <p class="feedbackreport"><a href="/feedback.html?app=" onClick="_gaq.push(['_trackEvent', 'Trip Planner Ads','ClickTo', '/contact/']);"><span>${_(u'Feedback/report a problem')}</span></a></p>
        </div><!-- end #sidebar-icons -->
        
    </aside><!-- end #sidebar -->
</%def>
##
## main content
##
<%
    itinerary = plib.get_itinerary(plan)
%>

    <h1 class="tripplanner-icon"><a href="${util.url_domain()}/desktop/planner_form.html">${_(u'Your Trip on TriMet')}</a></h1>
    <div id="details" class="group">
        <p class="origin"><img src="${util.img_url()}/start-end.png" width="0" height="1" /><strong>${_(u'From')}</strong> ${plan['from']['name']}</p>
        <p class="destination"><img src="${util.img_url()}/start-end.png" width="0" height="1" /><strong>${_(u'To')}</strong> ${plan['to']['name']}</p>
        <p class="tripinfo">${plib.get_depart_arrive(plan)} ${plib.get_time(plan, itinerary)} ${itinerary['date_info']['pretty_date']}, ${_(u'riding on transit')} <a href="planner_form.html?${plan['params']}" onclick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary edit top']);" class="hide">${_(u'Edit')}</a></p>
        <p class="tripinfo">${plib.get_optimize(plan)} ${_(u'with a maximum walk of')} 1 mile <a href="planner_form.html?${plan['params']}" onclick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary edit top']);" class="hide">${_(u'Edit')}</a></p>
    </div><!-- end #details -->

    %if len(plan['itineraries']) > 1:
    <ol id="plannertabs" class="group">
        ${plib.itin_tab(plan['itineraries'], 0, _(u'Your best bet'))}
        ${plib.itin_tab(plan['itineraries'], 1, _(u'Option 2'))}
        ${plib.itin_tab(plan['itineraries'], 2, _(u'Option 3'))}
    </ol><!-- end #tabs -->
    %endif

    <ol id="itinerary" class="transit">
        ##
        ## loop through the legs between start and end elements
        ## ${plib.render_leg(leg, n)}
        %for n, leg in enumerate(itinerary['legs']):
            ${plib.render_leg(leg, n)}
        %endfor
    </ol><!-- end #itinerary -->

    <p class="fare">${_(u'Fare for this trip')}: <a href="/fares/index.htm">${_(u'Adult')}: ${itinerary['fare']['adult']}, ${_(u'Youth')}: ${itinerary['fare']['youth']}, ${_(u'Honored Citizen')}: ${itinerary['fare']['honored']}</a></p>

%if itinerary['has_alerts']:
    <div id="alerts" class="group">
        <!--<a target="#" href="${util.url_domain()}/alerts/"><img border="0" src="${util.url_domain()}/v3/images/tripplanner/alert.png">${_(u'Service Alerts')}</a>-->
        TODO display full alert text and time alert is active
        <p><img src="${util.img_url()}/alert.png" />
            <span class="alert-text">Until further notice, the westbound stop on SE Division at 37th (Stop ID 1457) is closed.</span>
            <span class="alert-time">As of March 19 @ 10:15am</span>
        </p>
        <p><img src="${util.img_url()}/alert.png" />
            <span class="alert-text">Until further notice, the westbound stop on SE Division at 37th (Stop ID 1457) is closed.</span>
            <span class="alert-time">As of March 19 @ 10:15am</span>
        </p>
    </div><!-- end #alerts -->
%endif


    <div id="console" class="group hide">
        <p class="console-left">
            <a href="#" class="console-emailtext" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary email-text']);"><span>${_(u'Email/Text')}</span></a>
            <a href="javascript:window.print();" class="console-print" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'PrintClickTo', 'Itinerary print']);"><span>${_(u'Print')}</span></a>
            <a href="#" class="console-mobile" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary view on mobile']);"><span>${_(u'View on mobile')}</span></a>
        </p>
        <p class="console-right">
            <a href="planner_form.html#TODO URL PARAMS" class="console-returntrip" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary reverse']);"><span>${_(u'Return trip')}</span></a>
            <a href="planner_form.html#TODO URL PARAMS" class="console-edit" onClick="_gaq.push(['_trackEvent', 'TripPlanner', 'ClickTo', 'Itinerary edit']);"><span>${_(u'Edit/Start over')}</span></a>
        </p>
    </div><!-- end #console -->





