<%inherit file="/desktop/base.html"/>

<%namespace name="util"  file="/shared/util.mako"/>

<%
    has_alerts = True if 'alerts' in stop and len(stop['alerts']) > 0 else False
%>

<%def name="title()">TriMet: ${_(u'Stop ID')} ${stop['stop_id']} - ${stop['name']}</%def>
<%def name="app_css()">
    <link rel="stylesheet" href="${util.url_domain()}/css/triptools-ss.css" type="text/css" media="all" />
</%def>
<%def name="meta_data()">
    <meta name="Keywords"    content="Stops, stations"/>
    <meta name="Description" content="Select a bus or MAX line or enter a Stop ID number to get real-time arrival information. TransitTracker monitors the actual location of your bus or train, so you know exactly when your ride is coming."/>
</%def>

<%def name="side_bar()">
    <!-- begin #sidebar -->
    <aside id="aside" class="aside">
        <h2>${_(u'See also')}</h2>  
        <ul class="links">
            <li><a href="nearest_stops?lang=en&X=-122.675681&Y=45.420598">${_(u'Find closest stops to')} ${stop['name']}</a></li>
        </ul>
        <p class="feedback"><a href="feedback.html?app=stop&stopID=${stop['stop_id']}">${_(u'Having problems? Click here for technical support.')}</a></p>
        <p><a href="find_stop.html?stopID=${stop['stop_id']}" class="image">find stop</a></p>
    </aside>
    <!-- end #sidebar -->
</%def>

<%def name="stations_selected()">class="selected"</%def>
    <h1 class="stopsstations-icon"><a href="find_stop.html?stopID=${stop['stop_id']}">${_(u'Stops & Stations')}</a></h1>
    <div class="group">
        <div class="left-column">
            <h2>${_(u'Stop ID')} ${stop['stop_id']}
                %if has_alerts:
                ${util.alerts_inline_icon_link()}
                %endif
                <!-- TODO formatting for alert icon
                <a href="#alerts" class="stop-alert"><img src="${util.img_url()}/alert-icon.png" alt="Service alert at this stop" /></a>
                -->
            </h2>
            <p>${util.stop_and_city_name(stop)}</p>

            <h3>${_(u'Served by')}</h3>

            %for r in stop['routes']:
            <h4>${r['name']}</h4>
            <p>
                %if 'direction' in r:
                ${r['direction']}<br/>
                %endif
                <a href="${r['arrival_url']}">${_(u'Next arrivals')}</a>
                &nbsp;&bull;&nbsp; <a href="stop_schedule.html?stop_id=${stop['stop_id']}&route=${r['id']}">${_(u'Schedule')}</a> 
                &nbsp;&bull;&nbsp; <a href="${r['route_url']}" title="${_(u'Show map and schedules for this route')}.">${_(u'Route info')}</a>
            </p>
            %endfor

            %if len(stop['routes']) > 1:
            <h4>${_(u'All routes')}</h4>
            <p>
                <a class="hide" href="${stop['arrival_url']}">${_(u'Next arrivals')}</a>
                &nbsp;&bull;&nbsp; <a href="stop_schedule.html?stop_id=${stop['stop_id']}">${_(u'Schedule')}</a>
            </p>
            %endif

            %if len(stop['amenities']) > 1:
            <h3 class="tight">${_(u'Amenities')}</h3>
            <ul class="small">
                <!-- TODO: how to manage a localized set of attribute string???? -->
                %for a in stop['amenities']:
                <li>${a}</li>
                %endfor
            </ul>
            %endif

            %if has_alerts:
                ${util.alerts(stop['alerts'])}
            %endif
        </div><!-- end .left-column -->

        <div class="right-column">
            <!-- TODO: fix these urls, so that urls are dynamic / off depending upon agency, etc... -->
            <p><a href="http://ride.trimet.org/?zoom=16&pLat=${stop['lat']}&pLon=${stop['lon']}&pText=${stop['name']}"><img src="http://maps.trimet.org/eapi/ws/V1/stopimage/format/png/width/340/height/336/zoom/6/extraparams/format_options=layout:scale/id/${stop['stop_id']}" /></a></p>

            <p class="imap">
                <a href="http://ride.trimet.org/?zoom=16&pLat=${stop['lat']}&pLon=${stop['lon']}&pText=${stop['name']}">${_(u'View on Interactive Map')}</a><br />
                <span class="secondary">${_(u'High-speed connection recommended')}</span>
            </p>

            <h3 class="tight">${_(u'Plan a trip')}</h3>
            <p><a href="planner_form.html?to=${stop['stop_id']}">${_(u'to here')}</a> &ndash;  <a href="planner_form.html?from=${stop['stop_id']}">${_(u'from here')}</a></p>
        </div><!-- end .right-column -->
    </div><!-- end .group -->

