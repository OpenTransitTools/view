<!DOCTYPE html>
<html>
<head>
<title>Autocomplete Example</title>

<!--

    http://www.raymondcamden.com/index.cfm/2012/3/27/Example-of-Autocomplete-in-jQuery-Mobile
    http://www.raymondcamden.com/demos/2012/mar/27/service.cfc?method=getSuggestions&search=fr 

    http://andymatthews.net/code/autocomplete/complex.html
    http://andymatthews.net/code/autocomplete/data.cfc?method=search&returnformat=json&data=simple&term=ma
    https://github.com/commadelimited/autoComplete.js/blob/master/jqm.autoComplete-1.5.1.js
-->

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://code.jquery.com/mobile/latest/jquery.mobile.min.css" />
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/latest/jquery.mobile.min.js"></script>
</head>

<body>

<div data-role="page" id="mainPage">

    <div data-role="header">
        <h1>Autocomplete Example</h1>
    </div>

    <div data-role="content">

        <p>
        <input type="text" id="from_input" placeholder="From">
        <ul id="from_suggestions" data-role="listview" data-inset="true"></ul>
        </p>

        <br/>
        <p>
        <input type="text" id="to_input" placeholder="To">
        <ul id="to_suggestions" data-role="listview" data-inset="true"></ul>
        </p>


    </div>

    <div data-role="footer">
        <h4></h4>
    </div>

</div>

<script>
function clickr(n) {
    console.log(n);
}
function auto_suggest(form, sug_list)
{
    var sugList = $(sug_list);

    $(form).on("input", function(e) {
        var text = $(this).val();
        if(text.length < 1) {
            sugList.html("");
            sugList.listview("refresh");
        } else {
            //$.get("http://www.raymondcamden.com/demos/2012/mar/27/service.cfc?method=getSuggestions&callback=x", {search:text}, function(res,code) {
            $.get("http://maps.trimet.org/solr/select?start=0&rows=10&wt=json&qt=dismax&fq=(-type:26 AND -type:route)", {q:text}, function(res,code) {
                var str = "";

                docs = res.response.docs;
                len=docs.length;
                for(var i=0; i < len; i++)
                {
                    str += "<li><a target='#' onClick='clickr("+ i + ")'></a>" + docs[i].name + " (" + docs[i].city + ")</li>";
                }

                sugList.html(str);
                sugList.listview("refresh");
            },"json");
        }
    });
}


$("#mainPage").on("pageshow", function(e) {
    auto_suggest("#from_input", "#from_suggestions");
    auto_suggest("#to_input",   "#to_suggestions");
});
</script>

</body>
</html>